<!doctype html>
<html lang="ja">
  <head>
    <title>計算機</title>
    <!-- bootstrap5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <!-- css -->
    <style type="text/css">
    .one{
      width: 10em;
    }
    .two{
      width: 20em;
    }
    #show{
      width: 40em;
      height: 3em; 
    }
    </style>
  </head>
  <body>
    <div class="d-flex justify-content-center">
      <div id="show" class="p-3 mb-2 bg-dark text-white"></div>
    </div>
    <div class="d-flex justify-content-center">
      <button class="btn btn-secondary one" value="7">7</button>
      <button class="btn btn-secondary one" value="8">8</button>
      <button class="btn btn-secondary one" value="9">9</button>
      <button class="btn btn-warning one" value="+">+</button>
    </div>
    <div class="d-flex justify-content-center">
      <button class="btn btn-secondary one" value="4">4</button>
      <button class="btn btn-secondary one" value="5">5</button>
      <button class="btn btn-secondary one" value="6">6</button>
      <button class="btn btn-warning one" value="-">-</button>
    </div>
    <div class="d-flex justify-content-center">
      <button class="btn btn-secondary one" value="1">1</button>
      <button class="btn btn-secondary one" value="2">2</button>
      <button class="btn btn-secondary one" value="3">3</button>
      <button class="btn btn-warning one" value="*">*</button>
    </div>
    <div class="d-flex justify-content-center">
      <button class="btn btn-secondary one" value="0">0</button>
      <button class="btn btn-secondary one" value="00">00</button>
      <button class="btn btn-secondary one" value=".">.</button>
      <button class="btn btn-warning one" value="/">/</button>
    </div>
    <div class="d-flex justify-content-center">
      <button class="btn btn-warning two" value="AC">AC</button>
      <button class="btn btn-danger two" value="=">=</button>
    </div>
  </body>
  <script>

    var valid = function(data) {
      // 最初に * / . は NG
      if ($('#show').text() == '' && ['*', '/', '00', '.'].includes(data)) return false;

      // 連続して記号は NG
      if (['+', '-', '*', '/', '.'].includes($('#show').text().slice(-1)) && ['+', '-', '*', '/', '.'].includes(data)) return false;

      // 計算記号の後に00は NG
      if (['+', '-', '*', '/'].includes($('#show').text().slice(-1)) && data == '00') return false;

      return true;
    };

    // 変換機能の追加したい 00 と打つと 0 に変換  
    $(document).ready(function(){
      $('.btn').click(function(){
        var data = this.value;

        // 入力値のバリデーション
        if(!valid(data)) return;

        // 計算初期化 
        if ( data == 'AC') return $('#show').empty();

        // 計算
        if ( data == '=') return $('#show').text(eval($('#show').text()));

        // 画面に追加
        $('#show').append(data); 
      });
    });  
  </script> 
</html>
